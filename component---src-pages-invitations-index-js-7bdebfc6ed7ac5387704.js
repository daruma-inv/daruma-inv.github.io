"use strict";(self.webpackChunkcorporate=self.webpackChunkcorporate||[]).push([[108],{812:function(e,t,n){var a=n(4994);t.A=void 0;var l=a(n(2032)),r=n(4848);t.A=(0,l.default)((0,r.jsx)("path",{d:"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8z"}),"Update")},1376:function(e,t,n){n.r(t),n.d(t,{default:function(){return V}});var a=n(6540),l=n(8154),r=n(4945),i=n.n(r),c=n(9502),s=n(9828),o=n(9067),m=n(6990),u=n(7834),d=n(779),E=n(5239),A=n(4433),p=n(7458),f=n(5046),h=n(2924),y=n(4855),v=n(995),g=n(4137),w=n(3884),S=n(4774),b=n(3198),F=n(6627),x=n(6798),C=n(2471),k=n(8532),N=n(4073),D=n(6718),z=n(8031),B=n(8763),I=n(2477),U=n(7867),R=n(6831),L=n(1641),W=n(2397),$=n(177),T=n(2987),M=n(1966),P=n(6434),j=n(4348),O=n(443),J=n(4747),G=n(812),_=n(5673),q=n(542),H=n(7583),K=n(9399);var Q=e=>{const{0:t,1:n}=(0,a.useState)(e.clientsFriend.friendName),{0:l,1:r}=(0,a.useState)(e.clientsFriend.yourName),{0:c,1:s}=(0,a.useState)(e.clientsFriend.note),{0:u,1:d}=(0,a.useState)(e.clientsFriend.uuid),{0:A,1:p}=(0,a.useState)(e.clientsFriend.friendName),{0:y,1:g}=(0,a.useState)(e.clientsFriend.yourName),{0:w,1:b}=(0,a.useState)(e.clientsFriend.note),{0:F,1:k}=(0,a.useState)(!0),{0:D,1:Q}=(0,a.useState)(!0),{0:V,1:X}=(0,a.useState)(e.clientsFriend.validTimestamp),{0:Y,1:Z}=(0,a.useState)(e.clientsFriend.createdAt),{0:ee,1:te}=(0,a.useState)(e.clientsFriend.updatedAt),{0:ne,1:ae}=(0,a.useState)(e.clientsFriend.createdBy),{0:le,1:re}=(0,a.useState)(e.clientsFriend.updatedBy),{0:ie,1:ce}=(0,a.useState)(!1),{0:se,1:oe}=(0,a.useState)(!1),{0:me,1:ue}=(0,a.useState)(""),{0:de,1:Ee}=(0,a.useState)("");(0,a.useEffect)(()=>{const t=`https://daruma-inv.com/foryou/?uuid=${e.clientsFriend.uuid}`;(async()=>{try{const e=await H.toDataURL(t);Ee(e)}catch(e){console.error(e)}})(),ue(t),n(e.clientsFriend.friendName),r(e.clientsFriend.yourName),s(e.clientsFriend.note),d(e.clientsFriend.uuid),p(e.clientsFriend.friendName),g(e.clientsFriend.yourName),b(e.clientsFriend.note),k(!0),Q(!0),X(e.clientsFriend.validTimestamp),Z(e.clientsFriend.createdAt),te(e.clientsFriend.updatedAt),ae(e.clientsFriend.createdBy),re(e.clientsFriend.updatedBy)},[e.clientsFriend.uuid,e.clientsFriend.friendName,e.clientsFriend.yourName,e.clientsFriend.note,e.clientsFriend.validTimestamp,e.clientsFriend.createdAt,e.clientsFriend.updatedAt,e.clientsFriend.createdBy,e.clientsFriend.updatedBy]);const Ae=()=>ce(!1),pe=()=>{const{0:e,1:t}=(0,a.useState)(!1);return a.createElement(K.CopyToClipboard,{text:me,onCopy:()=>t(!0)},a.createElement(W.A,{onClose:()=>t(!1),open:e,title:"コピーしました"},a.createElement(m.A,{fullWidth:!0,variant:"outlined",size:"small",startIcon:a.createElement($.A,null)},"URLをコピーする")))};return a.createElement(a.Fragment,null,a.createElement(x.A,{hover:!0,selected:!F||!D},a.createElement(S.A,null,a.createElement(o.A,{display:"flex",flexDirection:"column"},a.createElement(o.A,null,a.createElement(m.A,{fullWidth:!0,variant:"outlined",size:"small",startIcon:a.createElement(_.A,null),onClick:()=>{oe(!0)}},"QRを表示する"),a.createElement(o.A,{mt:1},a.createElement(pe,null)),a.createElement(o.A,{mt:1},a.createElement(m.A,{fullWidth:!0,variant:"outlined",size:"small",startIcon:a.createElement(O.A,null),onClick:()=>{window.location.href=`mailto:?subject=一緒にコンパクトウシを始めませんか？&body=${A}様%0D%0A%0D%0A【コンパクトウシのご案内】%0D%0A${me}%0D%0A%0D%0A${y}`}},"メールで送る")),a.createElement(o.A,{mt:1},a.createElement(m.A,{fullWidth:!0,variant:"outlined",size:"small",color:"success",startIcon:a.createElement(M.A,null),onClick:()=>{const e=`https://social-plugins.line.me/lineit/share?url=${me}`;window.open(e,"_blank","noreferrer")}},"LINEで送る")),a.createElement(o.A,{mt:1},a.createElement(m.A,{fullWidth:!0,size:"small",color:"warning",endIcon:a.createElement(P.A,null),onClick:()=>window.open(me,"_blank","noreferrer")},"ご紹介ページを確認する"))),a.createElement(z.A,{open:se,onClose:()=>oe(!1)},a.createElement(R.A,null,a.createElement(N.A,{variant:"h6",textAlign:"center"},A,"様へのコンパクトウシご案内URL")),a.createElement(I.A,null,a.createElement(U.A,null,a.createElement("img",{src:de,style:{display:"block",margin:"0 auto",width:"100px",height:"100px"}}),me,a.createElement(pe,null)))))),a.createElement(S.A,null,a.createElement(C.A,{value:A,onChange:e=>{let{target:{value:n}}=e;const a=n!==t||y!==l||w!==c;k(!(n&&a)),Q(!a),p(n)},InputProps:{endAdornment:a.createElement(E.A,{position:"end"},"様")}})),a.createElement(S.A,null,a.createElement(C.A,{value:y,onChange:e=>{let{target:{value:n}}=e;const a=A!==t||n!==l||w!==c;k(!(A&&a)),Q(!a),g(n)},InputProps:{endAdornment:a.createElement(E.A,{position:"end"},"様")}})),a.createElement(S.A,null,a.createElement(h.A,{value:w,onChange:e=>{let{target:{value:n}}=e;const a=A!==t||y!==l||n!==c;k(!(A&&a)),Q(!a),b(n)},inputProps:{readOnly:!0}},a.createElement(f.A,{value:"職場同僚"},"職場同僚"),a.createElement(f.A,{value:"友人"},"友人"),a.createElement(f.A,{value:"親族"},"親族"),a.createElement(f.A,{value:"取引先"},"取引先"),a.createElement(f.A,{value:"その他"},"その他"))),a.createElement(S.A,null,a.createElement(v.A,{direction:"column",spacing:1},a.createElement(W.A,{title:"有効期限を延長する"},a.createElement("span",null,a.createElement(L.A,{color:"primary","aria-label":"update",size:"large",onClick:async()=>{try{const e=await i()(`https://api.daruma-inv.com/api/partners/clients/friends/${u}`,{method:"PUT",body:JSON.stringify({validTimestamp:new Date})});if(e.status>=400)throw new Error("Bad response /api/partners/clients");const{validTimestamp:t}=await e.json();console.log(t),X(t)}catch(e){alert("error"),console.log(e)}}},a.createElement(G.A,{fontSize:"inherit"})))),a.createElement(W.A,{title:"このレコードの変更を保存する"},a.createElement("span",null,a.createElement(L.A,{color:"primary","aria-label":"update",size:"large",disabled:F,onClick:async()=>{try{const e=await i()(`https://api.daruma-inv.com/api/partners/clients/friends/${u}`,{method:"PUT",body:JSON.stringify({friendName:A,yourName:y,note:w,updatedBy:"user"})});if(e.status>=400)throw new Error("Bad response /api/partners/clients");const{friendName:t,yourName:a,note:l,createdAt:c,updatedAt:o,createdBy:m,updatedBy:d}=await e.json();n(t),r(a),s(l),p(t),g(a),b(l),k(!0),Q(!0),Z(c),te(o),ae(m),re(d)}catch(e){alert("error"),console.log(e)}}},a.createElement(j.A,{fontSize:"inherit"})))),a.createElement(W.A,{title:"このレコードの変更を元に戻す"},a.createElement("span",null,a.createElement(L.A,{color:"warning","aria-label":"undo",size:"large",disabled:D,onClick:()=>{p(t),g(l),b(c),k(!0),Q(!0)}},a.createElement(J.A,{fontSize:"inherit"})))),a.createElement(W.A,{title:"このレコードを削除する"},a.createElement("span",null,a.createElement(L.A,{color:"error","aria-label":"delete",size:"large",onClick:()=>ce(!0)},a.createElement(T.A,{fontSize:"inherit"})))))),a.createElement(S.A,null,a.createElement(N.A,{variant:"body2",color:"primary"},(0,q.A)((()=>{const e=new Date(V);return e.setMonth(e.getMonth()+1),e})())," ",a.createElement("small",null,"(有効期限)")),a.createElement("br",null),a.createElement(N.A,{variant:"body2"},(0,q.A)(Y)," ",a.createElement("small",null,"作成")),a.createElement(N.A,{variant:"body2"},(0,q.A)(ee)," ",a.createElement("small",null,"更新")))),a.createElement(z.A,{open:ie,onClose:Ae,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},a.createElement(R.A,{id:"alert-dialog-title"},"このレコードの削除しますか？"),a.createElement(I.A,null,a.createElement(U.A,{id:"alert-dialog-description"},"ご友人、ご知人のお名前　: ",t,a.createElement("br",null),"お名前　: ",l,a.createElement("br",null),"メモ　　: ",c,a.createElement("br",null),"作成日時: ",(0,q.A)(Y),a.createElement("br",null),"更新日時: ",(0,q.A)(ee))),a.createElement(B.A,null,a.createElement(m.A,{onClick:Ae},"キャンセル"),a.createElement(m.A,{onClick:async()=>{try{if((await i()(`https://api.daruma-inv.com/api/partners/clients/friends/${u}`,{method:"DELETE"})).status>=400)throw new Error("Bad response /api/partners/clients/friends");e.reload(),ce(!1)}catch(t){console.log(t)}},autoFocus:!0},"削除する"))))};var V=()=>{const{0:e,1:t}=(0,a.useState)(!1),{0:n,1:r}=(0,a.useState)("info"),{0:z,1:B}=(0,a.useState)(""),{0:I,1:U}=(0,a.useState)(""),{0:R,1:L}=(0,a.useState)(""),{0:W,1:$}=(0,a.useState)(""),{0:T,1:M}=(0,a.useState)(!0),{0:P,1:j}=(0,a.useState)(""),{0:O,1:J}=(0,a.useState)(),{0:G,1:_}=(0,a.useState)(""),{0:q,1:H}=(0,a.useState)(""),{0:K,1:V}=(0,a.useState)(!1),{0:X,1:Y}=(0,a.useState)(0);return(0,a.useEffect)(()=>{const e=new URLSearchParams(window.location.search).get("uuid");j(e)},[]),(0,a.useEffect)(()=>{if(!P)return;(async()=>{try{const e=await i()(`https://api.daruma-inv.com/api/partners/clients/${P}`);if(404===e.status)throw V(!0),new Error("Bad response /api/partners/clients/{uuid}");const t=await i()(`https://api.daruma-inv.com/api/partners/clients/friends?partners-client-uuid=${P}`);if(t.status>=400)throw new Error("Bad response /api/partners/clients/friends{uuid}");const n=await e.json(),a=await t.json();_(n.name),H(n.partner.lastNameKanji),J(a),L(n.name)}catch(e){console.log(e)}})()},[X,P,K]),K?a.createElement(N.A,{align:"center",mt:5},"お探しのページは削除されたか見つかりません。",a.createElement("br",null),a.createElement("a",{href:"https://daruma-inv.com/"},"https://daruma-inv.com/")):P?a.createElement(a.Fragment,null,a.createElement(l.m,null,a.createElement("title",null,"お客様ご紹介ページ | DARUMA, Inc.")),a.createElement(s.A,{position:"fixed",sx:{backgroundColor:"#ef8468"}},a.createElement(u.A,{maxWidth:"xl"},a.createElement(k.A,{disableGutters:!0},a.createElement(N.A,{variant:"h6",noWrap:!0,fontWeight:"bold",sx:{mr:2,display:"flex",alignItems:"center"}},G," 様専用 お客様ご紹介ページ ",a.createElement("small",null,"(by DARUMA)")),a.createElement(o.A,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}}}),a.createElement(o.A,{display:"flex",flexDirection:"row",alignItems:"center"},a.createElement(o.A,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},a.createElement(N.A,{fontSize:14,fontWeight:"bold"},"DARUMA, Inc."),a.createElement(N.A,{fontSize:10},"[お客様限定]")))))),a.createElement(u.A,{maxWidth:"xl",sx:{mt:10}},a.createElement(N.A,null,a.createElement("strong",null,G),"様、DARUMAの ",q," ","です。いつもお世話になっております。"),a.createElement(N.A,null,"この機会にぜひご友人、ご知人に DARUMA をご紹介くださいませ。"),a.createElement(N.A,{variant:"body2",color:"error"},"※URLは有効期限1カ月となり、期日を過ぎますとアクセス出来なくなりますのでご了承下さい"),a.createElement(o.A,{display:"flex",my:2,pl:2,py:4,sx:{border:"2px solid #ccc",borderRadius:2}},a.createElement(C.A,{label:"ご友人・ご知人のお名前（ニックネーム可）",variant:"outlined",value:I,sx:{width:320},InputProps:{endAdornment:a.createElement(E.A,{position:"end"},"様")},onChange:e=>{const t=e.target.value;U(t),M(!R||!t||!W)}}),a.createElement(C.A,{label:"お客様のご氏名（ニックネーム可）",variant:"outlined",value:R,InputProps:{endAdornment:a.createElement(E.A,{position:"end"},"様")},sx:{width:240},onChange:e=>{const t=e.target.value;L(t),M(!t||!I||!W)}}),a.createElement(d.A,{required:!0,sx:{minWidth:120}},a.createElement(A.A,null,"ご関係"),a.createElement(h.A,{value:W,onChange:e=>{let{target:{value:t}}=e;$(t),M(!R||!I||!t)},label:"ご関係"},a.createElement(f.A,{value:"職場同僚"},"職場同僚"),a.createElement(f.A,{value:"友人"},"友人"),a.createElement(f.A,{value:"親族"},"親族"),a.createElement(f.A,{value:"取引先"},"取引先"),a.createElement(f.A,{value:"その他"},"その他"))),a.createElement(m.A,{variant:"contained",color:"primary",startIcon:a.createElement(D.A,null),disabled:T,onClick:async()=>{try{if((await i()("https://api.daruma-inv.com/api/partners/clients/friends",{method:"POST",body:JSON.stringify({partnersClientUuid:P,friendName:I,yourName:R,note:W,createdBy:"user"})})).status>=400)throw new Error("Bad response /api/partners/clients");t(!0),r("success"),B(`${I} 様の情報を追加しました`),U(""),L(""),$(""),M(!0),Y(X+1)}catch(e){alert("error"),console.log(e)}}},"新規作成")),a.createElement(b.A,null,a.createElement(g.A,null,a.createElement(F.A,null,a.createElement(x.A,null,a.createElement(S.A,null,"URL"),a.createElement(S.A,null,"ご友人・ご知人のお名前"),a.createElement(S.A,null,"お客様の氏名（ニックネーム可）"),a.createElement(S.A,null,"ご関係"),a.createElement(S.A,null,"操作"),a.createElement(S.A,null,"タイムスタンプ"))),a.createElement(w.A,null,void 0!==O&&O[0]?O.map((e,t)=>a.createElement(Q,{key:t,clientsFriend:e,reload:()=>Y(X+1)})):a.createElement(x.A,null,a.createElement(S.A,{colSpan:6},a.createElement(N.A,{align:"center"},void 0===O?a.createElement(a.Fragment,null,"Loading...",a.createElement(p.A,null)):"まだご紹介データがありません。『新規作成』より作成ください。")))))),a.createElement(v.A,{spacing:2,sx:{width:"100%"}},a.createElement(y.A,{open:e,autoHideDuration:5e3,onClose:(e,n)=>{"clickaway"!==n&&t(!1)}},a.createElement(c.A,{severity:n},z))))):a.createElement(a.Fragment,null)}}}]);
//# sourceMappingURL=component---src-pages-invitations-index-js-7bdebfc6ed7ac5387704.js.map